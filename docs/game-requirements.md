# Vampire Dungeon - ゲーム要件定義書

## 基本ゲームプレイ

### 操作方法
- 移動: 右クリックで指定位置へ移動（League of Legends形式）
- スキル: Q, W, E, Rキーで発動
- カメラ: プレイヤーキャラクターに固定

### ダンジョン構造
- 3階層のダンジョン + ボス戦で構成
- 各階層にはタイマーが設定される
- 各階層クリア後、報酬選択ステージに移行

### 報酬選択ステージ
以下の3つからランダムに選択肢が提示され、1つを選択可能：
1. 体力全回復
2. ショップへの移動
3. ランダムイベント
   - コスト: 100G
   - 効果: QスキルとWスキルを合成して新しいQスキルを作成

## スキルシステム

### 初期状態
- ゲーム開始時、QスキルにアーリのQスキルが固定で付与

### スキル獲得と管理
- ダンジョン内の箱を破壊してスキルアイテムを入手可能
- スキルアイテム取得時、3つのランダムスキルから1つを選択
- 選択したスキルはQ、W、E、Rキーのいずれかに割り当て可能
- 既にスキルが割り当てられているキーには新規スキルを割り当て不可
- 同じスキルを再取得した場合、そのスキルを強化可能

### スキル使用
- スキル使用にはマナが必要
- マナは時間経過で自動回復
- スキルは指定方向に発動

## スキル
- ダッシュ:キーを押したとき指定方向にダッシュする

## キャラクター管理

### 体力システム
- 体力は時間経過では回復しない
- 回復手段:
  - 報酬選択での全回復
  - アイテムによる回復（詳細未定）

### マナシステム
- スキル使用の消費リソース
- 時間経過で自動回復

## アイテムシステム

### 箱のドロップアイテム
- ランダムアイテム
- スキル獲得アイテム
- その他アイテム（詳細未定）

### 敵キャラクター
- スウォーム・ジェリー
  - 挙動：
    - プレイヤーに向かってゆっくり跳ねてくる（直線的で予測しやすい）。
    - 近づくと体当たりで微ダメージ（毒はなし）。
  - 特徴:
    - 倒すと1回だけ2体に分裂（最大でも2段階で終了）。
    - HPは低め（Qの往路か復路1発で倒せる）。
  - 戦略：
    - Ｑの復路で増えたジェリーも同時に倒し切れる
  - Three.jsポイント:
    - 跳ねる動きはMath.sin()で上下アニメ。
    - 分裂時にscaleを半分にしてclone()で2体生成、軽いパーティクルで「分裂感」を演出。

- アーチャー・ウィスプ (Archer Wisp)
  - 見た目：
    - 小さな浮遊する炎の精霊、弓を構えた姿。赤と黄色の炎が揺らめき、PointLightで周囲を微照。
    - レベルアップすると炎が青くなり、サイズが1.5倍に（scaleで拡大）。
  - 挙動：
    - プレイヤーから距離を取って（5～7m）浮遊。
    - 遠距離攻撃：炎の矢を2秒ごとに発射（直線軌道、速度3m/s）。
  - 攻撃特徴：
    - 炎の矢はプレイヤーか他の敵に当たるとダメージ（Qの1/3くらい）。
    - スウォーム・ジェリーを倒すと、その場でレベルアップ。
  - レベルアップ：
    - Lv1（初期）：HP低め、矢のダメージ弱。
    - Lv2（1体倒す）：HPとダメージ1.5倍、矢の速度アップ。紫色
    - Lv3（2体倒す）：HPとダメージ2倍、矢が貫通する（複数ヒット可）。青色

  - Three.jsポイント：
    - 矢はCylinderGeometryにParticleSystemで炎の軌跡。
    - レベルアップ時にscaleアニメと青いShaderMaterialで強化感。

### マップギミック
- 崩落ブロック (Crumbling Block)
  - 見た目：
    - ひび割れた石の壁や床（高さ2m、幅1mくらい）。BoxGeometryにクラックテクスチャで脆そうな雰囲気。
    - 崩れると瓦礫が散らばり、PlaneGeometryで薄暗いスローエリア（半径2mくらい）を生成。
  - 挙動：
    - プレイヤーもしくは敵の攻撃がヒットすると即座に崩落。

  - 効果：
    - 崩落に巻き込む：
      - 範囲内の敵（半径1m）にダメージ（Qの半分くらい）。
      - 巻き込んだ敵を0.5秒スタン（動き完全停止）。
    - スロー足場：
      - 崩落後に地面にスローエリア生成（半径2m、持続3秒）。
      - エリア内のキャラ（プレイヤー含む）の移動速度を50%減。

  - Three.jsポイント：
    - 崩落アニメはTWEEN.jsでブロックを落下、Physics（Cannon.js）で瓦礫を散らす。
    - スローエリアはPlaneGeometryにShaderMaterialで薄い霧エフェクト、境界にパルスアニメ。


## 今後の検討事項
- 各階層の具体的な時間制限
- スキルの詳細な仕様（ダメージ、効果、マナコストなど）
- ショップでの商品内容
- その他のドロップアイテムの種類と効果
- ボス戦の具体的な内容